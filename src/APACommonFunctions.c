/*************************************************************************************************************************************************
**                                                                                                                                              **
** Copyright (C) SAIC Technologies (2020)                                                                                                       **
**                                                                                                                                              **
** All rights reserved.                                                                                                                         **
**                                                                                                                                              **
** This document contains proprietary information belonging to SAIC                                                                             **
** Technologies. Passing on and copying of this document, and communication                                                                     **
** of its contents is not permitted without prior written authorization.                                                                        **
**                                                                                                                                              **
**************************************************************************************************************************************************
**                                                                                                                                              **
**  $FILENAME   : APACommonFunctions.c $                                                                                                        **
**                                                                                                                                              **
**  $CC VERSION : \main\94 $                                                                                                                    **
**                                                                                                                                              **
**  $DATE       : 2020-08-18 $                                                                                                                  **
**                                                                                                                                              **
**  AUTHOR      : SAIC - CH-Engineering                                                                                                         **
**                                                                                                                                              **
**  VENDOR      : SAIC Technologies                                                                                                             **
**                                                                                                                                              **
**  DESCRIPTION : This file contains                                                                                                            **
**                - Ultrasonic bottom data layer processing                 ..                                                                  **
**                                                                                                                                              **
**  MAY BE CHANGED BY USER [yes/no]: Yes                                                                                                        **
**                                                                                                                                              **
*************************************************************************************************************************************************/

/*************************************************************************************************************************************************
**                                                     Includes
*************************************************************************************************************************************************/
#include "APACommonFunctions.h"
#include "APACommonType.h"
#include "APACalibration.h"

/*************************************************************************************************************************************************
**                                                     Imported Compiler Switch Check                                                           **
*************************************************************************************************************************************************/
/**/

/*************************************************************************************************************************************************
**                                                     Private Macro Definitions                                                                **
*************************************************************************************************************************************************/
#define CF_SinTableNum 1573
#define CF_SintTableStepDeg  0.001
#define CF_SintTableStepHalfDeg  0.0005

/*************************************************************************************************************************************************
**                                                     Private Type Definitions                                                                 **
*************************************************************************************************************************************************/
/**/

/*************************************************************************************************************************************************
**                                                     Private Function Declarations                                                            **
*************************************************************************************************************************************************/
/**/

/*************************************************************************************************************************************************
**                                                     Global Constant Definitions                                                              **
*************************************************************************************************************************************************/
/**/
#define ALG_START_SEC_CONST_32BIT
#include "IS31_UserMemMap.h"

float32 const SinTableData[CF_SinTableNum]=
{
     0	          ,0.00099999981	,0.0019999987	,0.0029999956	,0.0039999895	,0.0049999794	,0.0059999642	,0.0069999429	,0.0079999147	,0.0089998785	,0.0099998331	,0.010999778	,0.011999712	,0.012999634	,0.013999542	,0.014999437	,0.015999317	,0.016999181	,0.017999029	,0.018998858	,0.019998666	,0.020998457	,0.021998225	,0.022997972	,0.023997696	,0.024997396	,0.025997071	,0.026996719	,0.027996341	,0.028995935	,0.029995501	,0.030995036	,0.031994540	,0.032994010	,0.033993449	,0.034992855	,0.035992224	,0.036991559	,0.037990857	,0.038990114	,0.039989334	,0.040988512	,0.041987654	,0.042986751	,0.043985803	,0.044984814	,0.045983780	,0.046982698	,0.047981571	,0.048980393	,0.049979169	,0.050977893	,0.051976569	,0.052975189	,0.053973760	,0.054972276	,0.055970736	,0.056969140	,0.057967488	,0.058965776	,0.059964005	,0.060962178	,0.061960287	,0.062958337	,0.063956320	,0.064954236	,0.065952092	,0.066949882	,0.067947604	,0.068945259	,0.069942847	,0.070940360	,0.071937807	,0.072935179	,0.073932484	,0.074929707	,0.075926855	,0.076923937	,0.077920929	,0.078917854	,0.079914697	,0.080911458	,0.081908137	,0.082904734	,0.083901249	,0.084897682	,0.085894033	,0.086890288	,0.087886468	,0.088882551	,0.089878552	,0.090874456	,0.091870271	,0.092865996	,0.093861632	,0.094857171	,0.095852613	,0.096847959	,0.097843207	,0.098838359	,0.099833414	,0.10082837	,0.10182323	,0.10281797	,0.10381263	,0.10480717	,0.10580161	,0.10679594	,0.10779017	,0.10878429	,0.10977830	,0.11077220	,0.11176600	,0.11275967	,0.11375324	,0.11474669	,0.11574002	,0.11673325	,0.11772635	,0.11871934	,0.11971220	,0.12070496	,0.12169758	,0.12269009	,0.12368248	,0.12467473	,0.12566687	,0.12665887	,0.12765077	,0.12864251	,0.12963414	,0.13062564	,0.13161701	,0.13260823	,0.13359934	,0.13459031	,0.13558115	,0.13657184	,0.13756241	,0.13855283	,0.13954312	,0.14053325	,0.14152327	,0.14251313	,0.14350285	,0.14449243	,0.14548187	,0.14647116	,0.14746030	,0.14844929	,0.14943813	,0.15042683	,0.15141538	,0.15240377	,0.15339202	,0.15438010	,0.15536803	,0.15635581	,0.15734343	,0.15833090	,0.15931821	,0.16030535	,0.16129234	,0.16227917	,0.16326582	,0.16425233	,0.16523866	,0.16622484	,0.16721085	,0.16819668	,0.16918235	,0.17016785	,0.17115317	,0.17213833	,0.17312333	,0.17410813	,0.17509277	,0.17607725	,0.17706153	,0.17804565	,0.17902957	,0.18001333	,0.18099689	,0.18198030	,0.18296351	,0.18394653	,0.18492937	,0.18591204	,0.18689451	,0.18787679	,0.18885890	,0.18984081	,0.19082253	,0.19180405	,0.19278540	,0.19376653	,0.19474749	,0.19572824	,0.19670880	,0.19768916	,0.19866933	,0.19964930	,0.20062907	,0.20160863	,0.20258799	,0.20356716	,0.20454612	,0.20552488	,0.20650342	,0.20748177	,0.20845990	,0.20943783	,0.21041554	,0.21139304	,0.21237035	,0.21334743	,0.21432430	,0.21530095	,0.21627739	,0.21725361	,0.21822962	,0.21920541	,0.22018097	,0.22115633	,0.22213146	,0.22310637	,0.22408104	,0.22505550	,0.22602974	,0.22700374	,0.22797753	,0.22895108	,0.22992440	,0.23089749	,0.23187035	,0.23284298	,0.23381539	,0.23478755	,0.23575948	,0.23673117	,0.23770262	,0.23867385	,0.23964483	,0.24061556	,0.24158606	,0.24255632	,0.24352634	,0.24449611	,0.24546564	,0.24643493	,0.24740396	,0.24837275	,0.24934129	,0.25030959	,0.25127763	,0.25224540	,0.25321296	,0.25418022	,0.25514725	,0.25611404	,0.25708055	,0.25804681	,0.25901282	,0.25997856	,0.26094404	,0.26190928	,0.26287422	,0.26383892	,0.26480335	,0.26576754	,0.26673144	,0.26769507	,0.26865843	,0.26962155	,0.27058437	,0.27154693	,0.27250922	,0.27347124	,0.27443299	,0.27539447	,0.27635565	,0.27731657	,0.27827722	,0.27923757	,0.28019765	,0.28115746	,0.28211698	,0.28307620	,0.28403518	,0.28499383	,0.28595221	,0.28691033	,0.28786814	,0.28882566	,0.28978291	,0.29073986	,0.29169652	,0.29265288	,0.29360893	,0.29456472	,0.29552022	,0.29647538	,0.29743028	,0.29838488	,0.29933918	,0.30029318	,0.30124688	,0.30220026	,0.30315337	,0.30410615	,0.30505863	,0.30601081	,0.30696270	,0.30791426	,0.30886552	,0.30981648	,0.31076711	,0.31171745	,0.31266746	,0.31361717	,0.31456655	,0.31551564	,0.31646439	,0.31741285	,0.31836098	,0.31930879	,0.32025626	,0.32120344	,0.32215029	,0.32309681	,0.32404304	,0.32498890	,0.32593447	,0.32687968	,0.32782459	,0.32876918	,0.32971340	,0.33065733	,0.33160090	,0.33254418	,0.33348709	,0.33442968	,0.33537194	,0.33631384	,0.33725542	,0.33819667	,0.33913758	,0.34007815	,0.34101838	,0.34195825	,0.34289780	,0.34383702	,0.34477586	,0.34571439	,0.34665254	,0.34759036	,0.34852785	,0.34946495	,0.35040173	,0.35133815	,0.35227424	,0.35320994	,0.35414532	,0.35508034	,0.35601500	,0.35694930	,0.35788324	,0.35881683	,0.35975006	,0.36068293	,0.36161542	,0.36254758	,0.36347938	,0.36441079	,0.36534184	,0.36627254	,0.36720285	,0.36813280	,0.36906239	,0.36999163	,0.37092048	,0.37184894	,0.37277704	,0.37370479	,0.37463215	,0.37555915	,0.37648574	,0.37741199	,0.37833783	,0.37926331	,0.38018841	,0.38111314	,0.38203746	,0.38296142	,0.38388500	,0.38480818	,0.38573098	,0.38665342	,0.38757545	,0.38849708	,0.38941833	,0.39033920	,0.39125967	,0.39217976	,0.39309946	,0.39401877	,0.39493766	,0.39585617	,0.39677429	,0.39769199	,0.39860934	,0.39952624	,0.40044278	,0.40135890	,0.40227461	,0.40318993	,0.40410486	,0.40501934	,0.40593347	,0.40684715	,0.40776044	,0.40867335	,0.40958580	,0.41049787	,0.41140953	,0.41232079	,0.41323161	,0.41414204	,0.41505203	,0.41596162	,0.41687080	,0.41777956	,0.41868791	,0.41959581	,0.42050332	,0.42141041	,0.42231706	,0.42322329	,0.42412910	,0.42503449	,0.42593947	,0.42684400	,0.42774811	,0.42865181	,0.42955506	,0.43045789	,0.43136027	,0.43226224	,0.43316376	,0.43406487	,0.43496552	,0.43586576	,0.43676555	,0.43766493	,0.43856382	,0.43946230	,0.44036037	,0.44125795	,0.44215512	,0.44305184	,0.44394812	,0.44484395	,0.44573933	,0.44663426	,0.44752875	,0.44842279	,0.44931641	,0.45020956	,0.45110226	,0.45199448	,0.45288628	,0.45377764	,0.45466852	,0.45555896	,0.45644891	,0.45733845	,0.45822752	,0.45911613	,0.46000427	,0.46089196	,0.46177918	,0.46266595	,0.46355224	,0.46443808	,0.46532345	,0.46620837	,0.46709281	,0.46797678	,0.46886027	,0.46974331	,0.47062588	,0.47150800	,0.47238961	,0.47327077	,0.47415143	,0.47503164	,0.47591138	,0.47679064	,0.47766942	,0.47854772	,0.47942555	,0.48030287	,0.48117974	,0.48205611	,0.48293203	,0.48380744	,0.48468238	,0.48555681	,0.48643079	,0.48730427	,0.48817724	,0.48904973	,0.48992175	,0.49079329	,0.49166432	,0.49253485	,0.49340490	,0.49427444	,0.49514350	,0.49601206	,0.49688014	,0.49774772	,0.49861479	,0.49948135	,0.50034744	,0.50121301	,0.50207806	,0.50294262	,0.50380671	,0.50467026	,0.50553334	,0.50639588	,0.50725794	,0.50811946	,0.50898051	,0.50984102	,0.51070106	,0.51156056	,0.51241952	,0.51327801	,0.51413602	,0.51499343	,0.51585037	,0.51670682	,0.51756269	,0.51841807	,0.51927298	,0.52012730	,0.52098113	,0.52183443	,0.52268726	,0.52353948	,0.52439123	,0.52524245	,0.52609313	,0.52694333	,0.52779293	,0.52864206	,0.52949065	,0.53033870	,0.53118622	,0.53203321	,0.53287965	,0.53372556	,0.53457093	,0.53541583	,0.53626013	,0.53710395	,0.53794718	,0.53878987	,0.53963202	,0.54047370	,0.54131478	,0.54215533	,0.54299533	,0.54383481	,0.54467368	,0.54551208	,0.54634994	,0.54718721	,0.54802394	,0.54886013	,0.54969579	,0.55053085	,0.55136538	,0.55219936	,0.55303282	,0.55386573	,0.55469805	,0.55552983	,0.55636102	,0.55719167	,0.55802178	,0.55885136	,0.55968034	,0.56050873	,0.56133664	,0.56216395	,0.56299067	,0.56381685	,0.56464249	,0.56546754	,0.56629199	,0.56711596	,0.56793928	,0.56876206	,0.56958431	,0.57040596	,0.57122701	,0.57204753	,0.57286745	,0.57368684	,0.57450563	,0.57532382	,0.57614148	,0.57695854	,0.57777500	,0.57859093	,0.57940626	,0.58022100	,0.58103514	,0.58184874	,0.58266175	,0.58347416	,0.58428603	,0.58509725	,0.58590794	,0.58671802	,0.58752751	,0.58833641	,0.58914477	,0.58995247	,0.59075963	,0.59156621	,0.59237212	,0.59317750	,0.59398228	,0.59478647	,0.59559005	,0.59639305	,0.59719545	,0.59799725	,0.59879845	,0.59959906	,0.60039902	,0.60119843	,0.60199726	,0.60279542	,0.60359305	,0.60439003	,0.60518640	,0.60598218	,0.60677737	,0.60757196	,0.60836589	,0.60915923	,0.60995197	,0.61074412	,0.61153567	,0.61232656	,0.61311686	,0.61390656	,0.61469561	,0.61548406	,0.61627191	,0.61705911	,0.61784571	,0.61863172	,0.61941713	,0.62020183	,0.62098598	,0.62176949	,0.62255239	,0.62333465	,0.62411630	,0.62489730	,0.62567770	,0.62645745	,0.62723660	,0.62801516	,0.62879300	,0.62957031	,0.63034689	,0.63112289	,0.63189828	,0.63267303	,0.63344711	,0.63422060	,0.63499343	,0.63576561	,0.63653719	,0.63730812	,0.63807839	,0.63884807	,0.63961709	,0.64038545	,0.64115316	,0.64192027	,0.64268672	,0.64345253	,0.64421767	,0.64498222	,0.64574611	,0.64650929	,0.64727187	,0.64803386	,0.64879513	,0.64955574	,0.65031576	,0.65107507	,0.65183377	,0.65259182	,0.65334916	,0.65410590	,0.65486199	,0.65561742	,0.65637219	,0.65712631	,0.65787977	,0.65863252	,0.65938467	,0.66013616	,0.66088694	,0.66163713	,0.66238660	,0.66313547	,0.66388363	,0.66463113	,0.66537797	,0.66612411	,0.66686964	,0.66761446	,0.66835862	,0.66910213	,0.66984499	,0.67058718	,0.67132866	,0.67206949	,0.67280960	,0.67354912	,0.67428792	,0.67502606	,0.67576349	,0.67650026	,0.67723638	,0.67797184	,0.67870659	,0.67944062	,0.68017399	,0.68090671	,0.68163878	,0.68237013	,0.68310076	,0.68383074	,0.68456006	,0.68528867	,0.68601662	,0.68674386	,0.68747038	,0.68819624	,0.68892145	,0.68964595	,0.69036973	,0.69109285	,0.69181526	,0.69253701	,0.69325805	,0.69397837	,0.69469804	,0.69541699	,0.69613522	,0.69685280	,0.69756967	,0.69828582	,0.69900131	,0.69971609	,0.70043015	,0.70114350	,0.70185620	,0.70256817	,0.70327944	,0.70398998	,0.70469981	,0.70540899	,0.70611745	,0.70682520	,0.70753223	,0.70823854	,0.70894414	,0.70964909	,0.71035326	,0.71105677	,0.71175957	,0.71246159	,0.71316296	,0.71386361	,0.71456355	,0.71526277	,0.71596122	,0.71665901	,0.71735609	,0.71805245	,0.71874809	,0.71944296	,0.72013718	,0.72083062	,0.72152340	,0.72221541	,0.72290671	,0.72359729	,0.72428715	,0.72497630	,0.72566473	,0.72635239	,0.72703934	,0.72772563	,0.72841108	,0.72909588	,0.72977990	,0.73046327	,0.73114586	,0.73182768	,0.73250884	,0.73318923	,0.73386884	,0.73454779	,0.73522598	,0.73590344	,0.73658013	,0.73725611	,0.73793137	,0.73860586	,0.73927963	,0.73995268	,0.74062496	,0.74129653	,0.74196732	,0.74263740	,0.74330670	,0.74397528	,0.74464309	,0.74531019	,0.74597657	,0.74664217	,0.74730700	,0.74797112	,0.74863446	,0.74929708	,0.74995893	,0.75062007	,0.75128043	,0.75194001	,0.75259888	,0.75325698	,0.75391430	,0.75457090	,0.75522673	,0.75588185	,0.75653619	,0.75718975	,0.75784254	,0.75849462	,0.75914592	,0.75979644	,0.76044625	,0.76109529	,0.76174355	,0.76239103	,0.76303774	,0.76368374	,0.76432896	,0.76497340	,0.76561707	,0.76625997	,0.76690215	,0.76754349	,0.76818413	,0.76882398	,0.76946306	,0.77010137	,0.77073890	,0.77137566	,0.77201164	,0.77264684	,0.77328134	,0.77391499	,0.77454787	,0.77518004	,0.77581137	,0.77644193	,0.77707177	,0.77770078	,0.77832901	,0.77895647	,0.77958316	,0.78020906	,0.78083420	,0.78145856	,0.78208214	,0.78270489	,0.78332692	,0.78394812	,0.78456855	,0.78518820	,0.78580707	,0.78642517	,0.78704244	,0.78765893	,0.78827465	,0.78888959	,0.78950375	,0.79011708	,0.79072964	,0.79134142	,0.79195237	,0.79256260	,0.79317200	,0.79378057	,0.79438841	,0.79499543	,0.79560161	,0.79620707	,0.79681164	,0.79741549	,0.79801852	,0.79862076	,0.79922217	,0.79982281	,0.80042267	,0.80102170	,0.80161995	,0.80221736	,0.80281401	,0.80340981	,0.80400485	,0.80459911	,0.80519247	,0.80578512	,0.80637693	,0.80696791	,0.80755812	,0.80814749	,0.80873609	,0.80932385	,0.80991077	,0.81049693	,0.81108224	,0.81166679	,0.81225049	,0.81283343	,0.81341553	,0.81399679	,0.81457722	,0.81515688	,0.81573570	,0.81631374	,0.81689095	,0.81746733	,0.81804287	,0.81861764	,0.81919158	,0.81976467	,0.82033700	,0.82090843	,0.82147908	,0.82204890	,0.82261795	,0.82318610	,0.82375348	,0.82432002	,0.82488573	,0.82545060	,0.82601464	,0.82657790	,0.82714033	,0.82770187	,0.82826263	,0.82882255	,0.82938164	,0.82993996	,0.83049738	,0.83105397	,0.83160973	,0.83216470	,0.83271879	,0.83327210	,0.83382452	,0.83437616	,0.83492690	,0.83547688	,0.83602595	,0.83657426	,0.83712167	,0.83766830	,0.83821404	,0.83875895	,0.83930308	,0.83984631	,0.84038872	,0.84093028	,0.84147096	,0.84201086	,0.84254992	,0.84308809	,0.84362549	,0.84416199	,0.84469765	,0.84523243	,0.84576643	,0.84629959	,0.84683186	,0.84736329	,0.84789389	,0.84842360	,0.84895253	,0.84948057	,0.85000777	,0.85053408	,0.85105962	,0.85158426	,0.85210800	,0.85263097	,0.85315305	,0.85367429	,0.85419464	,0.85471421	,0.85523283	,0.85575068	,0.85626763	,0.85678375	,0.85729897	,0.85781336	,0.85832691	,0.85883957	,0.85935140	,0.85986233	,0.86037242	,0.86088169	,0.86139005	,0.86189759	,0.86240423	,0.86291003	,0.86341494	,0.86391902	,0.86442220	,0.86492455	,0.86542600	,0.86592662	,0.86642635	,0.86692524	,0.86742324	,0.86792034	,0.86841661	,0.86891204	,0.86940658	,0.86990023	,0.87039304	,0.87088495	,0.87137598	,0.87186617	,0.87235546	,0.87284392	,0.87333149	,0.87381816	,0.87430400	,0.87478894	,0.87527299	,0.87575620	,0.87623852	,0.87671995	,0.87720048	,0.87768018	,0.87815899	,0.87863696	,0.87911397	,0.87959015	,0.88006544	,0.88053983	,0.88101339	,0.88148606	,0.88195783	,0.88242871	,0.88289869	,0.88336784	,0.88383603	,0.88430339	,0.88476986	,0.88523549	,0.88570017	,0.88616401	,0.88662690	,0.88708895	,0.88755012	,0.88801038	,0.88846976	,0.88892823	,0.88938588	,0.88984257	,0.89029837	,0.89075333	,0.89120734	,0.89166051	,0.89211279	,0.89256412	,0.89301461	,0.89346421	,0.89391285	,0.89436066	,0.89480758	,0.89525360	,0.89569867	,0.89614290	,0.89658624	,0.89702863	,0.89747018	,0.89791077	,0.89835054	,0.89878935	,0.89922726	,0.89966428	,0.90010047	,0.90053570	,0.90096998	,0.90140343	,0.90183598	,0.90226758	,0.90269834	,0.90312815	,0.90355706	,0.90398508	,0.90441221	,0.90483838	,0.90526372	,0.90568811	,0.90611160	,0.90653419	,0.90695584	,0.90737665	,0.90779650	,0.90821546	,0.90863347	,0.90905064	,0.90946686	,0.90988219	,0.91029662	,0.91071010	,0.91112268	,0.91153437	,0.91194516	,0.91235501	,0.91276395	,0.91317195	,0.91357911	,0.91398531	,0.91439056	,0.91479498	,0.91519845	,0.91560096	,0.91600257	,0.91640329	,0.91680312	,0.91720200	,0.91759998	,0.91799700	,0.91839314	,0.91878831	,0.91918266	,0.91957599	,0.91996843	,0.92035997	,0.92075062	,0.92114031	,0.92152905	,0.92191690	,0.92230386	,0.92268986	,0.92307490	,0.92345905	,0.92384231	,0.92422462	,0.92460603	,0.92498648	,0.92536598	,0.92574465	,0.92612231	,0.92649907	,0.92687488	,0.92724979	,0.92762381	,0.92799681	,0.92836899	,0.92874014	,0.92911041	,0.92947978	,0.92984819	,0.93021566	,0.93058223	,0.93094784	,0.93131250	,0.93167627	,0.93203908	,0.93240100	,0.93276191	,0.93312198	,0.93348104	,0.93383920	,0.93419647	,0.93455273	,0.93490809	,0.93526250	,0.93561602	,0.93596858	,0.93632019	,0.93667084	,0.93702060	,0.93736941	,0.93771726	,0.93806422	,0.93841016	,0.93875521	,0.93909937	,0.93944252	,0.93978477	,0.94012606	,0.94046640	,0.94080585	,0.94114429	,0.94148183	,0.94181842	,0.94215411	,0.94248879	,0.94282258	,0.94315541	,0.94348729	,0.94381821	,0.94414818	,0.94447726	,0.94480538	,0.94513249	,0.94545871	,0.94578397	,0.94610834	,0.94643170	,0.94675416	,0.94707561	,0.94739616	,0.94771576	,0.94803441	,0.94835210	,0.94866884	,0.94898462	,0.94929945	,0.94961339	,0.94992632	,0.95023829	,0.95054936	,0.95085949	,0.95116860	,0.95147681	,0.95178407	,0.95209032	,0.95239568	,0.95270008	,0.95300353	,0.95330596	,0.95360750	,0.95390809	,0.95420772	,0.95450640	,0.95480412	,0.95510083	,0.95539665	,0.95569152	,0.95598543	,0.95627832	,0.95657033	,0.95686132	,0.95715141	,0.95744050	,0.95772868	,0.95801586	,0.95830208	,0.95858735	,0.95887172	,0.95915508	,0.95943743	,0.95971888	,0.95999938	,0.96027893	,0.96055746	,0.96083504	,0.96111172	,0.96138740	,0.96166211	,0.96193588	,0.96220863	,0.96248049	,0.96275133	,0.96302128	,0.96329021	,0.96355820	,0.96382523	,0.96409124	,0.96435636	,0.96462047	,0.96488363	,0.96514583	,0.96540707	,0.96566731	,0.96592665	,0.96618497	,0.96644235	,0.96669871	,0.96695417	,0.96720862	,0.96746212	,0.96771467	,0.96796620	,0.96821684	,0.96846646	,0.96871507	,0.96896279	,0.96920949	,0.96945524	,0.96970004	,0.96994388	,0.97018671	,0.97042859	,0.97066951	,0.97090942	,0.97114837	,0.97138637	,0.97162336	,0.97185946	,0.97209454	,0.97232860	,0.97256172	,0.97279388	,0.97302508	,0.97325528	,0.97348452	,0.97371280	,0.97394007	,0.97416639	,0.97439176	,0.97461611	,0.97483951	,0.97506195	,0.97528338	,0.97550386	,0.97572339	,0.97594190	,0.97615939	,0.97637600	,0.97659159	,0.97680616	,0.97701985	,0.97723252	,0.97744417	,0.97765487	,0.97786462	,0.97807336	,0.97828114	,0.97848791	,0.97869372	,0.97889858	,0.97910243	,0.97930533	,0.97950721	,0.97970814	,0.97990805	,0.98010701	,0.98030502	,0.98050201	,0.98069799	,0.98089308	,0.98108709	,0.98128021	,0.98147231	,0.98166341	,0.98185354	,0.98204267	,0.98223084	,0.98241806	,0.98260427	,0.98278946	,0.98297369	,0.98315698	,0.98333925	,0.98352051	,0.98370081	,0.98388016	,0.98405850	,0.98423582	,0.98441219	,0.98458755	,0.98476195	,0.98493540	,0.98510784	,0.98527926	,0.98544973	,0.98561919	,0.98578769	,0.98595518	,0.98612171	,0.98628724	,0.98645180	,0.98661536	,0.98677790	,0.98693949	,0.98710012	,0.98725969	,0.98741835	,0.98757595	,0.98773265	,0.98788828	,0.98804295	,0.98819661	,0.98834932	,0.98850107	,0.98865175	,0.98880148	,0.98895025	,0.98909801	,0.98924476	,0.98939055	,0.98953533	,0.98967910	,0.98982191	,0.98996371	,0.99010456	,0.99024439	,0.99038327	,0.99052107	,0.99065799	,0.99079382	,0.99092871	,0.99106264	,0.99119550	,0.99132740	,0.99145836	,0.99158829	,0.99171722	,0.99184513	,0.99197209	,0.99209809	,0.99222302	,0.99234700	,0.99247003	,0.99259198	,0.99271297	,0.99283302	,0.99295199	,0.99307001	,0.99318707	,0.99330312	,0.99341816	,0.99353218	,0.99364525	,0.99375731	,0.99386835	,0.99397844	,0.99408752	,0.99419558	,0.99430269	,0.99440879	,0.99451387	,0.99461800	,0.99472111	,0.99482322	,0.99492437	,0.99502450	,0.99512362	,0.99522173	,0.99531889	,0.99541503	,0.99551022	,0.99560434	,0.99569750	,0.99578965	,0.99588084	,0.99597102	,0.99606019	,0.99614835	,0.99623555	,0.99632174	,0.99640697	,0.99649113	,0.99657434	,0.99665654	,0.99673778	,0.99681795	,0.99689716	,0.99697536	,0.99705261	,0.99712884	,0.99720407	,0.99727827	,0.99735153	,0.99742377	,0.99749500	,0.99756521	,0.99763447	,0.99770272	,0.99776995	,0.99783623	,0.99790144	,0.99796569	,0.99802893	,0.99809122	,0.99815249	,0.99821275	,0.99827200	,0.99833024	,0.99838752	,0.99844378	,0.99849904	,0.99855334	,0.99860662	,0.99865890	,0.99871016	,0.99876040	,0.99880970	,0.99885798	,0.99890524	,0.99895155	,0.99899679	,0.99904108	,0.99908435	,0.99912667	,0.99916792	,0.99920821	,0.99924749	,0.99928582	,0.99932307	,0.99935937	,0.99939466	,0.99942899	,0.99946225	,0.99949455	,0.99952585	,0.99955612	,0.99958539	,0.99961370	,0.99964100	,0.99966729	,0.99969256	,0.99971688	,0.99974018	,0.99976248	,0.99978375	,0.99980408	,0.99982333	,0.99984163	,0.99985892	,0.99987525	,0.99989057	,0.99990481	,0.99991810	,0.99993044	,0.99994171	,0.99995202	,0.99996132	,0.99996960	,0.99997693	,0.99998319	,0.99998850	,0.99999279	,0.99999607	,0.99999839	,0.99999970    ,1             ,1};

#define ALG_STOP_SEC_CONST_32BIT
#include "IS31_UserMemMap.h"

/*************************************************************************************************************************************************
**                                                     Global Variable Definitions                                                              **
*************************************************************************************************************************************************/

/*************************************************************************************************************************************************
**                                                     Private  Constant Definitions                                                            **
*************************************************************************************************************************************************/
/**/

/*************************************************************************************************************************************************
**                                                     Private  Variable Definitions                                                            **
*************************************************************************************************************************************************/
/**/

/*************************************************************************************************************************************************
**                                                     Global Function Definitions                                                              **
*************************************************************************************************************************************************/

#define ALG_START_SEC_CODE
#include "IS31_UserMemMap.h"

/*************************************************************************************************************************************************
** Syntax :  CF_mod2pmpi                                                                                                                        **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description :                                                               **
*************************************************************************************************************************************************/
static inline float32 CF_mod2pmpi(float32 theta)
{
    return ( theta - Math_PI*2.0*floor(theta /2.0/Math_PI) );  // [0,2*pi)
}

/*************************************************************************************************************************************************
** Syntax :  float32  CF_CalculationSin(float32 Ctemp)                                                                                               **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 sin value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of asinf() within -1 to 1                                                                                    **
*************************************************************************************************************************************************/
float32  CF_CalculationSin(float32 Ctemp)
{
    uint16 DownIndex;
    float32 temp;
    if ( Ctemp >= 0 && Ctemp <= Math_PI/2)
    {
        temp = Ctemp/CF_SintTableStepDeg;
        DownIndex = (uint16) (temp);
        return ( SinTableData[DownIndex] + (temp - DownIndex) * (SinTableData[DownIndex+1] - SinTableData[DownIndex]));
    }
    else if (Math_PI>=Ctemp && Ctemp>=Math_PI/2.0)
    {
        temp = (Math_PI-Ctemp)/CF_SintTableStepDeg;
        DownIndex = (uint16) (temp);
        return ( SinTableData[DownIndex] + (temp - DownIndex) * (SinTableData[DownIndex+1] - SinTableData[DownIndex]));
    }
    else if(Math_PI<=Ctemp && Ctemp<=Math_PI*3.0/2.0)
    {
        temp = (Ctemp-Math_PI)/CF_SintTableStepDeg;
        DownIndex = (uint16) (temp);
        return (-1)*( SinTableData[DownIndex] + (temp - DownIndex) * (SinTableData[DownIndex+1] - SinTableData[DownIndex]));
    }
    else
    {
        temp = (2.0*Math_PI-Ctemp)/CF_SintTableStepDeg;
        DownIndex = (uint16) (temp);
        return (-1)*( SinTableData[DownIndex] + (temp - DownIndex) * (SinTableData[DownIndex+1] - SinTableData[DownIndex]));
    }
} 
/*************************************************************************************************************************************************
** Syntax :  float32 CF_sin_tab(float32 Deg)                                                                                                    **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 sin value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of asinf() within -1 to 1                                                                                    **
*************************************************************************************************************************************************/
float32 CF_sin_tab(float32 Deg)   
{           
    if(Deg<0)
    {
        return -1 * CF_CalculationSin(CF_mod2pmpi(-Deg));

    }
    else
    {
        return CF_CalculationSin(CF_mod2pmpi(Deg));
    }

  }   
/*************************************************************************************************************************************************
** Syntax :  float32 CF_cos_tab(float32 Deg)                                                                                                    **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 sin value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of asinf() within -1 to 1                                                                                    **
*************************************************************************************************************************************************/
float32 CF_cos_tab(float32 Deg)   
 {   
    return CF_sin_tab(Math_PI/2+(Deg<0?(-Deg):Deg));  
 }

/*************************************************************************************************************************************************
** Syntax :  float32 ProtectedAsinf(float32 f32X)                                                                                               **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 sin value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of asinf() within -1 to 1                                                                                    **
*************************************************************************************************************************************************/
float32 ProtectedAsinf(float32 f32X)
{
    if (f32X <= -1.0)
    {
          f32X = -1.0;
    }
    else if (f32X >= 1.0)
    {
          f32X = 1.0;
    }

    return (float32)asinf(f32X);
}

/*************************************************************************************************************************************************
** Syntax :  float32 ProtectedAcosf(float32 f32X)                                                                                               **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of acosf() within -1 to 1                                                                                    **
*************************************************************************************************************************************************/
float32 ProtectedAcosf(float32 f32X)
{
    if (f32X <= -1.0)
    {
          f32X = -1.0;
    }
    else if (f32X >= 1.0)
    {
          f32X = 1.0;
    }

    return (float32)acosf(f32X);
}

/*************************************************************************************************************************************************
** Syntax :  float32 ProtectedSqrtf(float32 f32X)                                                                                               **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of sqrtf() bigger than 0.                                                                                    **
*************************************************************************************************************************************************/
float32 ProtectedSqrtf(float32 f32X)
{
    if (f32X <= 0)
    {
          return 0;
    }
    return (float32)sqrtf(f32X);
}

/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
float32 ProtectedTanf(float32 f32AngularRad)
{
	float32 tempTan;
	tempTan = tanf(f32AngularRad);
    if (tempTan >= 65535.0)
    {
        return 65535.0;
    }

    if (tempTan <= -65535.0)
    {
        return -65535.0;
    }

    return tempTan;
}

/*************************************************************************************************************************************************
** Syntax :  CF_GetLineKnownPointOnLineAndParallelLline                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : retrun LineABC with know point on line and parallel line ABC.                                                              **
*************************************************************************************************************************************************/
LineABC_ST CF_GetLineKnownPointOnLineAndParallelLline(Point_ST *stPointOnLinePtr,LineABC_ST *stParallelLineABCPtr)
{
	//default line type: AX + BY + C =0: ABC{A,-1,C} Then A will be the slope directly
	LineABC_ST Line = {0,0,0};

	if (Math_fabs(stParallelLineABCPtr->f32B) < 0.0001)
	{
		/*This is a Horizontal line*/
		Line.f32A = 1.0;
		Line.f32C = - stPointOnLinePtr->f32XMtr;
	}
	else
	{
		Line.f32A = - stParallelLineABCPtr->f32A / stParallelLineABCPtr->f32B;
		Line.f32B = -1;
		Line.f32C = - Line.f32A * stPointOnLinePtr->f32XMtr - Line.f32B * stPointOnLinePtr->f32YMtr;
	}
	return Line;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Known vector coordinates Calculate the angle between two lines.                                                               **
*************************************************************************************************************************************************/
 float32 CalculateAngleBetweenTwoLines(float32 Vectorx1, float32 Vectory1, float32 Vectorx2, float32 Vectory2)
 {
 	float32 CosAngle = (Vectorx1 * Vectorx2 + Vectory1 * Vectory2)/sqrtf(powf(Vectorx1,2)+ powf(Vectory1,2))*sqrtf(powf(Vectorx2,2)+powf(Vectory2,2));
 	return CosAngle;
 }

/*************************************************************************************************************************************************
** Syntax :  CalculatePointToLineDistance                                                                                                       **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Known point and line Calculate point to line distance.                                                                         **
*************************************************************************************************************************************************/
 float32 CalculatePointToLineDistance(float32 Pointx,float32 Pointy,float32 LineA,float32 LineB,float32 LineC)
 {
	/*Ax+BY+C = 0*/
 	float32 f32Distance = Math_fabs(LineA*Pointx + LineB*Pointy + LineC)/sqrtf(LineA*LineA + LineB*LineB);
 	return f32Distance;
 }
 


/*************************************************************************************************************************************************
** Syntax :                                                                     **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description :                                                                **
*************************************************************************************************************************************************/
void CF_CrdTrnsPoseKnownNewOrgInOldCrd(float32 input_f32PoseInOldCrd_X_m,
                                       float32 input_f32PoseInOldCrd_Y_m,
                                       float32 input_f32PoseInOldCrd_A_rad,
                                       float32 input_f32NewCrdOrgInOldCrd_X_m,
                                       float32 input_f32NewCrdOrgInOldCrd_Y_m,
                                       float32 input_f32NewCrdOrgInOldCrd_A_rad,
                                       float32 *output_f32NewPoseInNewCrd_X_m,
                                       float32 *output_f32NewPoseInNewCrd_Y_m,
                                       float32 *output_f32NewPoseInNewCrd_A_rad)
{
  float32 c_output_stNewPoseInNewCrd_X_m_;
  float32 d_output_stNewPoseInNewCrd_X_m_;
  float32 e_output_stNewPoseInNewCrd_X_m_;
  float32 f_output_stNewPoseInNewCrd_X_m_;

  c_output_stNewPoseInNewCrd_X_m_ = input_f32PoseInOldCrd_X_m - input_f32NewCrdOrgInOldCrd_X_m;
  d_output_stNewPoseInNewCrd_X_m_ = Math_sin(input_f32NewCrdOrgInOldCrd_A_rad);
  e_output_stNewPoseInNewCrd_X_m_ = input_f32PoseInOldCrd_Y_m - input_f32NewCrdOrgInOldCrd_Y_m;
  f_output_stNewPoseInNewCrd_X_m_ = Math_cos(input_f32NewCrdOrgInOldCrd_A_rad);

  *output_f32NewPoseInNewCrd_X_m = c_output_stNewPoseInNewCrd_X_m_ * f_output_stNewPoseInNewCrd_X_m_ + e_output_stNewPoseInNewCrd_X_m_ * d_output_stNewPoseInNewCrd_X_m_;
  *output_f32NewPoseInNewCrd_Y_m = -c_output_stNewPoseInNewCrd_X_m_ * d_output_stNewPoseInNewCrd_X_m_ + e_output_stNewPoseInNewCrd_X_m_ * f_output_stNewPoseInNewCrd_X_m_;
  *output_f32NewPoseInNewCrd_A_rad = input_f32PoseInOldCrd_A_rad - input_f32NewCrdOrgInOldCrd_A_rad;
}

/*************************************************************************************************************************************************
** Syntax :  CF_CrdTrnsPoseKnownOldOrgInNewCrd                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
void CF_CrdTrnsPoseKnownOldOrgInNewCrd(float32 input_f32PoseInOldCrd_X_m,
                                       float32 input_f32PoseInOldCrd_Y_m,
                                       float32 input_f32PoseInOldCrd_A_rad,
                                       float32 input_f32OldCrdOrgInMewCrd_X_m,
                                       float32 input_f32OldCrdOrgInMewCrd_Y_m,
                                       float32 input_f32OldCrdOrgInMewCrd_A_rad,
                                       float32 *output_f32NewPoseInNewCrd_X_m,
                                       float32 *output_f32NewPoseInNewCrd_Y_m,
                                       float32 *output_f32NewPoseInNewCrd_A_rad)
{
    float32 NewPoseInNewCrd_X_m_f32_tmp;
    float32 b_NewPoseInNewCrd_X_m_f32_tmp;
    float32 c_output_stNewPoseInNewCrd_X_m_;
    float32 d_output_stNewPoseInNewCrd_X_m_;

    NewPoseInNewCrd_X_m_f32_tmp = Math_sin(input_f32OldCrdOrgInMewCrd_A_rad);
    b_NewPoseInNewCrd_X_m_f32_tmp = Math_cos(input_f32OldCrdOrgInMewCrd_A_rad);

    c_output_stNewPoseInNewCrd_X_m_ = input_f32PoseInOldCrd_X_m - ((0.0F - input_f32OldCrdOrgInMewCrd_X_m) * b_NewPoseInNewCrd_X_m_f32_tmp 
                                      + (0.0F - input_f32OldCrdOrgInMewCrd_Y_m) * NewPoseInNewCrd_X_m_f32_tmp);
    d_output_stNewPoseInNewCrd_X_m_ = Math_sin(0.0F - input_f32OldCrdOrgInMewCrd_A_rad);
    NewPoseInNewCrd_X_m_f32_tmp = input_f32PoseInOldCrd_Y_m - (-(0.0F - input_f32OldCrdOrgInMewCrd_X_m) * NewPoseInNewCrd_X_m_f32_tmp 
                                      + (0.0F - input_f32OldCrdOrgInMewCrd_Y_m) * b_NewPoseInNewCrd_X_m_f32_tmp);
    b_NewPoseInNewCrd_X_m_f32_tmp = Math_cos(0.0F - input_f32OldCrdOrgInMewCrd_A_rad);
    *output_f32NewPoseInNewCrd_X_m = c_output_stNewPoseInNewCrd_X_m_ * b_NewPoseInNewCrd_X_m_f32_tmp + NewPoseInNewCrd_X_m_f32_tmp * d_output_stNewPoseInNewCrd_X_m_;
    *output_f32NewPoseInNewCrd_Y_m = -c_output_stNewPoseInNewCrd_X_m_ * d_output_stNewPoseInNewCrd_X_m_ + NewPoseInNewCrd_X_m_f32_tmp *  b_NewPoseInNewCrd_X_m_f32_tmp;
    *output_f32NewPoseInNewCrd_A_rad = input_f32PoseInOldCrd_A_rad - (0.0F - input_f32OldCrdOrgInMewCrd_A_rad);
}

/*************************************************************************************************************************************************
** Syntax :  CF_CrdTrnsPointKnownNewOrgInOldCrd                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Coordinate system transformation,  Calculate the new x, y, A in new coordinate                                                             **
*************************************************************************************************************************************************/
void CF_CrdTrnsPointKnownNewOrgInOldCrd(float32 input_f32PoseInOldCrd_X_m,
                                        float32 input_f32PoseInOldCrd_Y_m,
                                        float32 input_f32NewCrdOrgInOldCrd_X_m,
                                        float32 input_f32NewCrdOrgInOldCrd_Y_m,
                                        float32 input_f32NewCrdOrgInOldCrd_A_rad,
                                        float32 *output_f32NewPoseInNewCrd_X_m,
                                        float32 *output_f32NewPoseInNewCrd_Y_m)
{
    float32 c_output_stNewPoseInNewCrd_X_m_;
    float32 d_output_stNewPoseInNewCrd_X_m_;
    float32 e_output_stNewPoseInNewCrd_X_m_;
    float32 f_output_stNewPoseInNewCrd_X_m_;

    c_output_stNewPoseInNewCrd_X_m_ = input_f32PoseInOldCrd_X_m - input_f32NewCrdOrgInOldCrd_X_m;
    d_output_stNewPoseInNewCrd_X_m_ = Math_sin(input_f32NewCrdOrgInOldCrd_A_rad);
    e_output_stNewPoseInNewCrd_X_m_ = input_f32PoseInOldCrd_Y_m - input_f32NewCrdOrgInOldCrd_Y_m;
    f_output_stNewPoseInNewCrd_X_m_ = Math_cos(input_f32NewCrdOrgInOldCrd_A_rad);

    *output_f32NewPoseInNewCrd_X_m = c_output_stNewPoseInNewCrd_X_m_ * f_output_stNewPoseInNewCrd_X_m_ + e_output_stNewPoseInNewCrd_X_m_ * d_output_stNewPoseInNewCrd_X_m_;
    *output_f32NewPoseInNewCrd_Y_m = -c_output_stNewPoseInNewCrd_X_m_ * d_output_stNewPoseInNewCrd_X_m_ + e_output_stNewPoseInNewCrd_X_m_ * f_output_stNewPoseInNewCrd_X_m_;
}

/*************************************************************************************************************************************************
** Syntax :  CF_CrdTrnsPointKnownOldOrgInNewCrd                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description :                                                               **
*************************************************************************************************************************************************/
void CF_CrdTrnsPointKnownOldOrgInNewCrd(float32 input_f32PoseInOldCrd_X_m,
                                        float32 input_f32PoseInOldCrd_Y_m,
                                        float32 input_f32OldCrdOrgInMewCrd_X_m,
                                        float32 input_f32OldCrdOrgInMewCrd_Y_m,
                                        float32 input_f32OldCrdOrgInMewCrd_A_rad,
                                        float32 *output_f32NewPoseInNewCrd_X_m,
                                        float32 *output_f32NewPoseInNewCrd_Y_m)
{
    float32 NewPoseInNewCrd_X_m_f32_tmp;
    float32 b_NewPoseInNewCrd_X_m_f32_tmp;
    float32 c_output_stNewPoseInNewCrd_X_m_;
    float32 d_output_stNewPoseInNewCrd_X_m_;

    NewPoseInNewCrd_X_m_f32_tmp = Math_sin(input_f32OldCrdOrgInMewCrd_A_rad);
    b_NewPoseInNewCrd_X_m_f32_tmp = Math_cos(input_f32OldCrdOrgInMewCrd_A_rad);

    c_output_stNewPoseInNewCrd_X_m_ = input_f32PoseInOldCrd_X_m 
                                      - ((0.0F - input_f32OldCrdOrgInMewCrd_X_m) * b_NewPoseInNewCrd_X_m_f32_tmp 
                                      + (0.0F - input_f32OldCrdOrgInMewCrd_Y_m) * NewPoseInNewCrd_X_m_f32_tmp);

    d_output_stNewPoseInNewCrd_X_m_ = Math_sin(0.0F - input_f32OldCrdOrgInMewCrd_A_rad);

    NewPoseInNewCrd_X_m_f32_tmp = input_f32PoseInOldCrd_Y_m
                                  - (-(0.0F - input_f32OldCrdOrgInMewCrd_X_m) * NewPoseInNewCrd_X_m_f32_tmp 
                                  + (0.0F - input_f32OldCrdOrgInMewCrd_Y_m) * b_NewPoseInNewCrd_X_m_f32_tmp);

    b_NewPoseInNewCrd_X_m_f32_tmp = Math_cos(0.0F - input_f32OldCrdOrgInMewCrd_A_rad);
    
    *output_f32NewPoseInNewCrd_X_m = c_output_stNewPoseInNewCrd_X_m_ * b_NewPoseInNewCrd_X_m_f32_tmp
                                     + NewPoseInNewCrd_X_m_f32_tmp * d_output_stNewPoseInNewCrd_X_m_;
    *output_f32NewPoseInNewCrd_Y_m = -c_output_stNewPoseInNewCrd_X_m_ * d_output_stNewPoseInNewCrd_X_m_ 
                                     + NewPoseInNewCrd_X_m_f32_tmp * b_NewPoseInNewCrd_X_m_f32_tmp;
}

/*************************************************************************************************************************************************
** Syntax :  CF_CrdTrnsLineABCKnownNewOrgInOldCrd.                                                                                              **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): Pose_ST stPoseNewOrgInOldCrd                                                                                                **
**                  LineABC_ST  stOldLine                                                                                                       **
**                  LineABC_ST  *stNewLine                                                                                                      **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: 0 - Fail; 1 - OK                                                                                                               **
**                                                                                                                                              **
** Description :                                                                **
*************************************************************************************************************************************************/
uint8 CF_CrdTrnsLineABCKnownNewOrgInOldCrd(Pose_ST stPoseNewOrgInOldCrd,
                                           LineABC_ST stOldLine,
                                           LineABC_ST *stNewLine)
{
    Point_ST stPointA,stPointB;

    if( Math_fabs(stOldLine.f32A) < 0.001 )
    {
        if ( Math_fabs(stOldLine.f32B) < 0.001)
        {
            return 0;
        }
        else
        {
            stPointA.f32XMtr = 0;
            stPointA.f32YMtr = - (stOldLine.f32C) / stOldLine.f32B;
            stPointB.f32XMtr = 1;
            stPointB.f32YMtr = - (stOldLine.f32C + stOldLine.f32A) / stOldLine.f32B;
        }          
    }
    else if ( Math_fabs(stOldLine.f32B) < 0.001)
    {
	
        stPointA.f32XMtr = - stOldLine.f32C / stOldLine.f32A;
        stPointA.f32YMtr = 0;
        stPointB.f32XMtr = - (stOldLine.f32B + stOldLine.f32C) / stOldLine.f32A;
        stPointB.f32YMtr = 1;
    }
    else
    {
        if ( Math_fabs(stOldLine.f32C) < 0.001)
        {
            stPointA.f32XMtr = 0;
            stPointA.f32YMtr = - stOldLine.f32C / stOldLine.f32B;
            stPointB.f32XMtr = 1;
            stPointB.f32YMtr = - (stOldLine.f32C + stOldLine.f32A) / stOldLine.f32B;
        }
        else
        {
            stPointA.f32XMtr = 0;
            stPointA.f32YMtr = - stOldLine.f32C / stOldLine.f32B;
            stPointB.f32XMtr = - stOldLine.f32C / stOldLine.f32A;
            stPointB.f32YMtr = 0;
        }
    }   

    CF_CrdTrnsPointKnownNewOrgInOldCrd(stPointA.f32XMtr,
                                       stPointA.f32YMtr,
                                       stPoseNewOrgInOldCrd.f32XMtr,
                                       stPoseNewOrgInOldCrd.f32YMtr,
                                       stPoseNewOrgInOldCrd.f32ARad,
                                       &stPointA.f32XMtr,
                                       &stPointA.f32YMtr);
    
    CF_CrdTrnsPointKnownNewOrgInOldCrd(stPointB.f32XMtr,
                                       stPointB.f32YMtr,
                                       stPoseNewOrgInOldCrd.f32XMtr,
                                       stPoseNewOrgInOldCrd.f32YMtr,
                                       stPoseNewOrgInOldCrd.f32ARad,
                                       &stPointB.f32XMtr,
                                       &stPointB.f32YMtr);
    
    CF_GetLineABCByTwoPoint(stPointA,
                            stPointB,
                            stNewLine);
    return 1;
}

/*************************************************************************************************************************************************
** Syntax :                                                                     **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description :                                                               **
*************************************************************************************************************************************************/
void CF_GetLineABCByTwoPoint(Point_ST stPointA,
                             Point_ST stPointB,
                             LineABC_ST *stLine) 
{
    // return value:
    // 0 -- Normal, ie. oblique line. inclined line
    // 1 - vertical.
    // 2 - horizontal.
	float32 DX, DY;

	DX = stPointA.f32XMtr - stPointB.f32XMtr;
	if( Math_fabs(DX) <= 0.001) 
	{
		// Vertical
        stLine->f32A = 1;
        stLine->f32B = 0;
        stLine->f32C = -stPointA.f32XMtr;
		return;
	} 
	else 
	{
		DY = stPointA.f32YMtr - stPointB.f32YMtr;
        stLine->f32A = DY / DX;
        stLine->f32B = -1;
        stLine->f32C = -(stLine->f32A * stPointA.f32XMtr +  stLine->f32B * stPointA.f32YMtr);
        return;
	}
}

/*************************************************************************************************************************************************
** Syntax :                                                                     **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description :                                                                **
*************************************************************************************************************************************************/
APA_DISTANCE_CAL_INT_TYPE APASlotProcCalTwoPtApproximateDisInt(
	                                                            APACoordinateDataType Pt1,
	                                                            APACoordinateDataType Pt2)
{
	// Notes: the max tol: 0.55%.

	APA_DISTANCE_CAL_INT_TYPE X1, Y1, Dis;
	APA_DISTANCE_CAL_FLOAT_TYPE fDis1, fDis2, fDis3, fDis4;

	X1 = (Pt1.x - Pt2.x);
	if(X1 < 0)
    {
		X1 = -X1;
	}
	Y1 = (Pt1.y - Pt2.y);
	if(Y1 < 0)
    {
		Y1 = - Y1;
	}

	if(X1 > Y1)
    {
		Dis = Y1;
		Y1 = X1;
		X1 = Dis;
	}

	if(X1 == 0)
    {
		return (APA_DISTANCE_CAL_INT_TYPE)Y1;
	}
	fDis1 = X1;
	fDis2 = Y1;
	fDis3 = fDis1 / fDis2;
	if(fDis3 < 0.7)
    {
		// < 35deg
		fDis4 = 0.075;
	} 
    else if(fDis3 < 0.87)
    {
		// < 41deg
		fDis4 = 0.033;
	} 
    else if(fDis3 < 0.9325)
    {
		// < 43 deg
		fDis4 = 0.0135;
	} 
    else 
    {
		fDis4 = 0.002;
	}

	fDis1 = fDis2 + fDis1 * (fDis3 * 0.4142 + fDis3 * fDis3 * fDis4);
	Y1 = (APA_DISTANCE_CAL_INT_TYPE)fDis1;
	return Y1;
}

/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APACoordinateDataCalFloatType APASlotProcCalSlotRelativeToCarCoordinateBySlotDisToCar(
                                                                                        APA_DISTANCE_TYPE SlotDepth,
                                                                                        APA_INDEX_TYPE SnsIndex) 
{
	APACoordinateDataCalFloatType SlotPt;
	APA_DISTANCE_CAL_FLOAT_TYPE DisToObj;

	if(SlotDepth == NO_OBJ_DISTANCE) 
    {
		SlotPt.y = APACal.SnsPos[SnsIndex].y;
		if(APACal.SnsPos[SnsIndex].x > 0)
			SlotPt.x = APACal.WidthOfCar / 2;
		else
			SlotPt.x = - APACal.WidthOfCar / 2;
	} 
    else 
    {
		if((SnsIndex == APA_FLS_SNS_INDEX)
		   || (SnsIndex == APA_RLS_SNS_INDEX)) 
        {
			DisToObj = -(APA_DISTANCE_CAL_FLOAT_TYPE)SlotDepth;
		} 
        else 
        {
			DisToObj = (APA_DISTANCE_CAL_FLOAT_TYPE)SlotDepth;
		}
		SlotPt.x = (APA_DISTANCE_CAL_FLOAT_TYPE)DisToObj + APACal.SnsPos[SnsIndex].x;
		SlotPt.y = APACal.SnsPos[SnsIndex].y;
	}
	return SlotPt;
}

/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_CAL_FLOAT_TYPE APATrajCalMathSqrt(
                                        APA_CAL_FLOAT_TYPE X)
{
	if(X <= 0)
    {
		return 0;
	}
	return (APA_CAL_FLOAT_TYPE)sqrtf(X);
}

/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_CAL_FLOAT_TYPE APATrajCalMathAsin(
                                        APA_CAL_FLOAT_TYPE X)
{
	if(X <= (-1.0))
    {
		X = - 1.0;
	} else if(X >= 1.0)
    {
		X = 1.0;
	}
	return (APA_CAL_FLOAT_TYPE)asinf(X);
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_CAL_FLOAT_TYPE APATrajCalMathAcos(
                                        APA_CAL_FLOAT_TYPE X)
{
	if(X <= (-1.0))
    {
		X = - 1.0;
	} 
    else if(X >= 1.0)
    {
		X = 1.0;
	}
	return (APA_CAL_FLOAT_TYPE)acosf(X);
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_CAL_FLOAT_TYPE APATrajCalMathTan(
                                        APA_CAL_FLOAT_TYPE X)
{
	APA_CAL_FLOAT_TYPE Ang;
	APA_INT_TYPE Y;

	Ang = X - PI/2.0;
	if(MATH_FABS(Ang) < 0.001)
    {
		// very close to PI / 2
		return 1e5;
	}
	
	Ang = X + PI/2.0;
	if(MATH_FABS(Ang) < 0.001)
    {
		// very close to - PI / 2
		return -1e5;
	} 
	
	Ang = X * (2.0 / PI);

	Y = (APA_INT_TYPE)Ang;

	if((Y & ((APA_INT_TYPE)1)) == ((APA_INT_TYPE)1))
    {
		Ang -= Y;
		if(MATH_FABS(Ang) < 0.001)
        {
			// X is very close to PI/2 times.
			if(X < 0)
            {
				// just return a big very.
				return - 1e5;
			} 
            else 
            {
				return 1e5;
			}
		}
	}
	return (APA_CAL_FLOAT_TYPE)tanf(X);
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APALineIsVerticalOrHorizontalType APATrajCalCheckIfTheCarIsDrivingVerticallyOrHorizontally(
                                                                                            APA_ANGLE_TYPE CarAng) 
{
// Important note: CarAng should less than PI and great than - PI;
// return value:
// 0 -- Normal, ie. oblique line. inclined line
// 1 - vertical.
// 2 - horizontal.

	if(CarAng < 0) 
    {
		CarAng = -CarAng;
	}

	if((CarAng < APACal.APATrajCalCarDriveVerticallyMaxCarAng)
	   || ((CarAng > PI - APACal.APATrajCalCarDriveVerticallyMaxCarAng)	&& (CarAng < (PI + APACal.APATrajCalCarDriveVerticallyMaxCarAng)))) 
    {
		return APALineIsVertical;
	} 
    else if((CarAng > APACal.APATrajCalCarDriveHorMinCarAng)
	        && (CarAng < (PI - APACal.APATrajCalCarDriveHorMinCarAng))) 
    {
		return APALineIsHorizontal;
	}
	return APALineIsIncline;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_DISTANCE_CAL_FLOAT_TYPE APATrajCalGetPointToLineDis(
                                                            APACoordinateDataCalFloatType Pt,
                                                            APALineParameterABCType LinePar) 
{
	APA_DISTANCE_CAL_FLOAT_TYPE L1, L2;
	if(LinePar.LineType == APALineIsIncline) 
    {
		L1 = MATH_FABS(LinePar.A * Pt.x - Pt.y + LinePar.C);
		L2 = LinePar.A * LinePar.A + 1.0;
		L2 = MATH_SQRT(L2);
		L1 = L1 / L2;
	} 
    else if(LinePar.LineType == APALineIsVertical) 
    {
		L1 = MATH_FABS(LinePar.C - Pt.x);
	} 
    else 
    {
		L1 = MATH_FABS(LinePar.C - Pt.y);
	}
	return L1;
}


#if 0
APA_DISTANCE_CAL_FLOAT_TYPE APATrajCalGetPointToLineDis(
    APACoordinateDataCalFloatType Pt,
APALineParameterABCType *pLinePar) {

	APA_DISTANCE_CAL_FLOAT_TYPE L1, L2;
	if(pLinePar->LineType == APALineIsIncline) {
		L1 = MATH_FABS(pLinePar->A * Pt.x - Pt.y + pLinePar->C);
		L2 = pLinePar->A * pLinePar->A + 1.0;
		L2 = MATH_SQRT(L2);
		L1 = L1 / L2;
	} else if(pLinePar->LineType == APALineIsVertical) {
		L1 = MATH_FABS(pLinePar->C - Pt.x);
	} else {
		L1 = MATH_FABS(pLinePar->C - Pt.y);
	}
	return L1;
}

#endif
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_CAL_FLOAT_TYPE APATrajCalTwoPointInterpolationCalculation(
                                                                APA_CAL_FLOAT_TYPE Y1, 
														        APA_CAL_FLOAT_TYPE Y2,
														        APA_CAL_FLOAT_TYPE X1,
														        APA_CAL_FLOAT_TYPE X2,
														        APA_CAL_FLOAT_TYPE X)
{
	APA_CAL_FLOAT_TYPE K, B, Y, DX;

	if(X <= X1)
    {
		return Y1;
	}
	if(X >= X2)
    {
		return Y2;
	}
	DX = (X1- X2);
	if(MATH_FABS(DX) > CALTOLERANCE)
    {
		K = (Y1 - Y2) / DX;
		B = Y1 - K * X1;
		Y = K * X + B;
		return Y;
	} 
    else 
    {
		return 1e5;
	}
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_DISTANCE_CAL_INT_TYPE APATrajCalGetTwoPointDisInt(
                                                        APA_DISTANCE_TYPE X1,
                                                        APA_DISTANCE_TYPE Y1,
                                                        APA_DISTANCE_TYPE X2,
                                                        APA_DISTANCE_TYPE Y2) 
{
	APA_DISTANCE_CAL_INT_TYPE L1, L2;
	APA_DISTANCE_CAL_FLOAT_TYPE L;

	L1 = (APA_DISTANCE_CAL_INT_TYPE)X1 - (APA_DISTANCE_CAL_INT_TYPE)X2;
	L2 = (APA_DISTANCE_CAL_INT_TYPE)Y1 - (APA_DISTANCE_CAL_INT_TYPE)Y2;
	L1 *= L1;
	L2 *= L2;
	L1 += L2;
	L = MATH_SQRT((APA_DISTANCE_CAL_FLOAT_TYPE)(L1));
	L2 = (APA_DISTANCE_CAL_INT_TYPE)L;
	return L2;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
BOOLEAN APATrajCalLineParABCbyTwoPoints(
                                        APACoordinateDataCalFloatType Pt1,
                                        APACoordinateDataCalFloatType Pt2,
                                        APALineParameterABCType *pLinePar) 
{
// return value:
//
// TRUE - OK, the line is exist
// FALSE - NG, the line is not exist, the two point is the same.
// Line equation:
// AX + BY + C = 0;
//
// if the following equation is exist:
// Y = K1X + C1;
// then,
// B = 1;
// A = K1;
// C = C1;
//
// That is:
// Y = AX + C;
//
// if the line is vertical:
// that is B = 0, then equation will be:
// X = C; (A = 1)
//
// if the line is horizontal:
// that is A = 0, then equation will be:
// Y = C; (B = 1)
//
	APA_DISTANCE_CAL_FLOAT_TYPE DX, DY, A, K;

	DX = Pt1.x - Pt2.x;
	DY = Pt1.y - Pt2.y;
	if(DX == 0) 
    {
		// Vertical
		// X = C;
		if(DY == 0) 
        {
			pLinePar->LineType = APALineIsInvalidLineType;
			return FALSE;
		}
		pLinePar->A = 1.0;
		pLinePar->C = Pt1.x;
		pLinePar->LineType = APALineIsVertical;
	} 
    else 
    {
		A = DY / DX;
		K = MATH_FABS(A);
		if(K > APACal.APATrajCalLineIsVMaxK) 
        {
			// Vertical
			// X = C;
			pLinePar->A = 1.0;
			pLinePar->C = Pt1.x;
			pLinePar->B = 0;  //add the code by liuzulong on 2012.08.27
			pLinePar->LineType = APALineIsVertical;
		} 
        else if(K < APACal.APATrajCalLineIsHMinK) 
        {
			// Horizotal.
			// Y = C;
			pLinePar->A = 0.0;
			pLinePar->C = Pt1.y;
			pLinePar->B = 1;//add the code by liuzulong on 2012.08.27
			pLinePar->LineType = APALineIsHorizontal;
		} 
        else 
        {
			// Line Lc is a normal line.
			// Normal line
			// Y = AX + C;
			pLinePar->A = A;
			pLinePar->C = Pt1.y - A * Pt1.x;
			pLinePar->LineType = APALineIsIncline;
			pLinePar->B = -1;//add the code by liuzulong on 2012.08.27
		}
	}
	return TRUE;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
void APATrajCalCopyMemory(
                            UCHAR *  pDst,
                            UCHAR *  pSrc,
                            APA_INT_TYPE Size) 
{

	while(Size > 0) 
    {
		(*pDst) = (*pSrc);
		pDst ++;
		pSrc ++;
		Size --;
	}
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_DISTANCE_CAL_FLOAT_TYPE APATrajCalGetTwoPointDisFloat(
                                                            APACoordinateDataCalFloatType Pt1,
                                                            APACoordinateDataCalFloatType Pt2) 
{
	APA_DISTANCE_CAL_FLOAT_TYPE L1, L2;
	L1 = Pt1.x - Pt2.x;
	L2 = Pt1.y - Pt2.y;
	L1 *= L1;
	L2 *= L2;
	L1 += L2;
	L2 = MATH_SQRT(L1);
	return L2;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_ENUM_TYPE APATrajCalCarDriveTrajectoryByTwoCarPos(
                                                        APACarCoordinateDataCalFloatType CarCurPt,
                                                        APACarCoordinateDataCalFloatType CarPrevPt,
                                                        APALineParameterABCType * pCarDrvLinePar,
                                                        APACoordinateDataCalFloatType *pCircleCenterPt,
                                                        APA_DISTANCE_CAL_FLOAT_TYPE *pRc)
{

	/*
		return value:
		0: error
		1: Line
		2: circle
		
		pLinePar->
		pLinePar->LineType = APALineIsInvalidLineType

		will return circle
	*/

	APA_DISTANCE_CAL_FLOAT_TYPE dbTemp1;
	APALineParameterABCType LinePar;
	BOOLEAN bCalResult;


	dbTemp1 = MATH_FABS(CarPrevPt.Coordinate.x - CarCurPt.Coordinate.x) + MATH_FABS(CarPrevPt.Coordinate.y - CarCurPt.Coordinate.y);

	if((dbTemp1 < 200) 
       || (MATH_FABS(CarPrevPt.CarAng - CarCurPt.CarAng) < (dbTemp1 / APA_TRAJCAL_CAR_DRIVE_STRAIGHTLY_TOL_MAX_CHECK_DIS * APACal.APATrajCalCarDriveStraightlyTolCarAngle))) 
    {
		// Car drive along straight lane.
		(*pCarDrvLinePar) = APATrajCalLineParABCByCurrentCarPosition(&CarCurPt, 0); // Line with the same direction with the car.
		return 1;
	} 
    else 
    {
		// Circle center of O1 (X1, Y1):
		LinePar = APATrajCalLineParABCByCurrentCarPosition(&CarCurPt, 1); // Line with the same direction with the car.
		bCalResult = APATrajCalCircleRadiusAndCenterPointByTwoPointOnArcAndLineCrossCenterPt(
		                 CarCurPt.Coordinate,
		                 CarPrevPt.Coordinate,
		                 LinePar,
		                 pCircleCenterPt,
		                 pRc
		             );

		if(((*pRc) < APACal.APATrajCalMinRearAxisCenterTurningRadius)
		    || (bCalResult == FALSE)) 
        {
			// ?? the car can not park into the radius less than curve radius = 3m road.
			return 0;
		}
		return 2;
	}

	return 0;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APALineParameterABCType APATrajCalLineParABCByCurrentCarPosition(
                                                                    APACarCoordinateDataCalFloatType *pCurCarPos,
                                                                    APA_ENUM_TYPE LineType)
{
// Input Parameter:
// CarCurPt - current car position
// LineType - 0: Line which has the same direction with the car and crosses the current car position.
//          - 1: Line which is perpendicular with the car direction and crosses the current car position.
// Output Parameter:
// Line parameter A B C.
// Vertical: X = C; A = 1;
// Horizontal: Y = C; A = 0;
// Incline: Y = AX + C;


	APALineParameterABCType LinePar;

	LinePar.LineType = APATrajCalCheckIfTheCarIsDrivingVerticallyOrHorizontally(pCurCarPos->CarAng);

	if(LineType == 0)
    {
		// Tangent line.
		if(LinePar.LineType == APALineIsIncline) 
        {
			// Line is a normal line.
			LinePar.A = MATH_TAN(PI / 2 + pCurCarPos->CarAng);
			//LinePar.B = 1.0;
			LinePar.B = -1;  //code have been changed by lzl on 2012.8.27
			LinePar.C = pCurCarPos->Coordinate.y - LinePar.A * pCurCarPos->Coordinate.x;

		} 
        else if(LinePar.LineType == APALineIsVertical) 
        {
			// vertical
			LinePar.A = 1;
			LinePar.B = 0;
			LinePar.C = pCurCarPos->Coordinate.x;
		} 
        else 
        {
			// horizontal line
			LinePar.A = 0;
			LinePar.B = 1;
			LinePar.C = pCurCarPos->Coordinate.y;
		}
	} 
    else 
    {
		// Line cross the car turning circle center point.
		if(LinePar.LineType == APALineIsIncline) 
        {
			// Line is a normal line.
			LinePar.A = MATH_TAN(pCurCarPos->CarAng);
			LinePar.B = -1;//code have been changed by lzl on 2012.8.27
			LinePar.C = pCurCarPos->Coordinate.y - LinePar.A * pCurCarPos->Coordinate.x;

		} 
        else if(LinePar.LineType == APALineIsHorizontal) 
        {
			// vertical
			LinePar.A = 1.0;
			LinePar.B = 0;
			LinePar.C = pCurCarPos->Coordinate.x;
			LinePar.LineType = APALineIsVertical;
		} 
        else 
        {
			// horizontal line
			LinePar.A = 0;
			LinePar.B = 1;
			LinePar.C = pCurCarPos->Coordinate.y;
			LinePar.LineType = APALineIsHorizontal;
		}
	}
	return LinePar;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
BOOLEAN APATrajCalCircleRadiusAndCenterPointByTwoPointOnArcAndLineCrossCenterPt(
                                                                                APACoordinateDataCalFloatType Pt1,
                                                                                APACoordinateDataCalFloatType Pt2,
                                                                                APALineParameterABCType LC,
                                                                                APACoordinateDataCalFloatType *pCircleCenterPt,
                                                                                APA_DISTANCE_CAL_FLOAT_TYPE *pRadius) 
{
// Notes:

// Input parameter:

// Pt1 - Point 1 on the circle, current car position.
// Pt2 - Point 2 on the circle
// LC - Line cross the circle center point.

// Output Parameter:

// pCircleCenterPt - calcuated circle center point.
// pRadius - calculated circle radius.

	/*
	(X1 - X0)^2 + (Y1 - Y0)^2 = R^2   -  (1)
	(X2 - X0)^2 + (Y2 - Y0)^2 = R^2   -  (2)
	A*X0 + B*Y0 + C = 0              -  (3)
	*/

	APA_DISTANCE_CAL_FLOAT_TYPE D1 , D2, D3;
	APACoordinateDataCalFloatType Ptc, CrossPoint;


	if((Pt1.x == Pt2.x) && (Pt1.y == Pt2.y)) 
    {
		return FALSE;
	}

	if(LC.LineType == APALineIsHorizontal) 
    {
		// Horizontal line
		Ptc.y = LC.C;
		if(Pt1.x == Pt2.x) 
        {
			// Pt1 and Pt2 has the same X coordinate. it is imposible to calculate the circle
			return FALSE;
		}
		Ptc.x = (Pt1.x * Pt1.x - Pt2.x * Pt2.x + Pt1.y * Pt1.y - Pt2.y * Pt2.y + (Pt2.y - Pt1.y) * 2.0 * Ptc.y) / 2.0 / (Pt1.x - Pt2.x);
	} 
    else if(LC.LineType == APALineIsVertical) 
    {
		// V line
		Ptc.x = LC.C;
		if(Pt1.y == Pt2.y) 
        {
			// Pt1 and Pt2 has the same y coordinate. it is imposible to calculate the circle
			return FALSE;
		}
		Ptc.y = (Pt1.y * Pt1.y - Pt2.y * Pt2.y + Pt1.x * Pt1.x - Pt2.x * Pt2.x + (Pt2.x - Pt1.x) * 2.0 * Ptc.x) / 2.0 / (Pt1.y - Pt2.y);
	} 
    else 
    {
		D1 = 2.0 * (Pt1.y - Pt2.y);
		D2 = (Pt1.x * Pt1.x - Pt2.x * Pt2.x + Pt1.y * Pt1.y - Pt2.y * Pt2.y);
		D3 = 2.0 * (Pt1.x - Pt2.x);
		D3 = D1 * LC.A + D3;
		if(D3 == 0) 
        {
			// it is imposible to calculate the circle.
			//return FALSE;
			////add code on 2012.7.28 by lwh
			CrossPoint.x = Pt1.x - (Pt1.x - Pt2.x) / 2;
			CrossPoint.y = Pt1.y - (Pt1.y - Pt2.y) / 2;
			if(CrossPoint.y == LC.A * CrossPoint.x + LC.C) 
            {
				Ptc.x = CrossPoint.x;
				Ptc.y = CrossPoint.y;
				D2 = (Ptc.x - Pt1.x) * (Ptc.x - Pt1.x) ;
				D2 += (Ptc.y - Pt1.y) * (Ptc.y - Pt1.y);
				///need to check the radius value?
				//(*pRadiusSquare) = D2;        //changed by lwh on 2012.8.27
				(*pRadius) = MATH_SQRT(D2);
				pCircleCenterPt->x = Ptc.x;
				pCircleCenterPt->y = Ptc.y;
				return TRUE;
			} 
            else 
            {
				return FALSE;
			}
			////add code on 2012.7.28 by lwh
		}
		Ptc.x = -(D1 * LC.C - D2) / D3;     ///code be changed
		//Ptc.x = (D1 * LC.C - D2) / D3;
		Ptc.y = LC.A * Ptc.x + LC.C;
	}
	D1 = (Pt1.x - Ptc.x);
	D1 *= D1;
	D2 = (Pt1.y - Ptc.y);
	D2 *= D2;
	D1 += D2;
//(*pRadiusSquare) = D1;   //changed by lwh on 2012.8.27
	(*pRadius) = MATH_SQRT(D1);
	pCircleCenterPt->x = Ptc.x;
	pCircleCenterPt->y = Ptc.y;
	return TRUE;
}

#if 1
//### Changed 2012 05 02
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_ENUM_TYPE APATrajCalCrossPointOfTwoCircles(
                                                APACoordinateDataCalFloatType Ptc0,
                                                APA_DISTANCE_CAL_FLOAT_TYPE R0,
                                                APACoordinateDataCalFloatType Ptc1,
                                                APA_DISTANCE_CAL_FLOAT_TYPE R1,
                                                APACoordinateDataCalFloatType *  pPtc2)
{

//### Changed with nothing and only noted that all these algorithm leads to great error... 2012 01 05###
//### Take the following coordinate for example

	/******************************************************************************
	Ptc0: (-524.145, 5490.0122) with radius of 7585.7861
	Ptc0: (-524.14526, 5490.0122) with radius of 7585.7861
	Ptc1: (-2686.9749, -5834.1997) with radius of 3943.1167
	*******************************************************************************/

// Known value:
// Center point of the circle 0: Ptc0(X0, Y0)
// Radius of the circle 1: R0
// Center point of the circle 1: Ptc1(X1, Y1)
// Radius of the circle 2: R1
//
// return value:
// 0 - error no solution,
// 1 - one solution,
// 2 - two solution.
//
	APA_DISTANCE_CAL_FLOAT_TYPE D1, D2, D3, D4, D5, D0;
	APA_CAL_FLOAT_TYPE A, B, C;

	D5 = Ptc1.x - Ptc0.x;
	D3 = Ptc0.y - Ptc1.y;
	D0 = D3 * D3 + D5 * D5;
	D0 = MATH_SQRT(D0);


//### Changend with changing the first D1 , in which the divider is changed form D5 to -D5... 20120116
//### Found by LiWeiHong
	if(MATH_FABS(D5) < CALTOLERANCE) 
    {
		if(MATH_FABS(D3) < CALTOLERANCE) 
        {
			// the cicle center of these two circle is the same.
			return 0;
		}
		// use .y to calculate.
		D2 = D3;
		D3 = D5;
		D5 = D2;
		D4 = Ptc0.x * Ptc0.x - R0 * R0;
		//D1 = (Ptc1.y * Ptc1.y + Ptc1.x * Ptc1.x - D4 - R1 * R1 - Ptc0.y * Ptc0.y) / 2 / (-D5);
		D1 = (Ptc1.y * Ptc1.y + Ptc1.x * Ptc1.x - D4 - R1 * R1 - Ptc0.y * Ptc0.y) / 2 / D5;        //the code was changed by lwh on 2012.3.16

		D2 = D3 / D5;
		//D3 = D1 - Ptc0.y;
		D3 = D1 + Ptc0.y;          //the code was changed by lwh on 2012.3.16

		A = D2 * D2 + 1;
		// B = 2.0 * (Ptc0.x - D2 * D3);
		B = 2.0 * (Ptc0.x + D2 * D3);     //the code was changed by lwh on 2012.3.16
		C = D3 * D3 + D4;

		D3 = B * B - 4.0 * A * C;

//### Changed for inducing erroes... 20120117

		if((MATH_FABS(D0 - MATH_FABS(R0 + R1)) <= APA_TRAJCAL_DIS_CAL_VALUE_IS_EQUAL_TOL)
		|| (MATH_FABS(D0 - MATH_FABS(R0 - R1)) <= APA_TRAJCAL_DIS_CAL_VALUE_IS_EQUAL_TOL)) 
        {
			//		if(MATH_FABS(D3) <= APA_TRAJCAL_DIS_CAL_SQRT_VALUE_IS_ZERO_TOL){   // MATH_FABS=fabsf        APA_TRAJCAL_DIS_CAL_SQRT_VALUE_IS_ZERO_TOL =400
			// Only one solution:
			// ??? Error ??
			pPtc2[0].x = (B) / 2 / A;
			//	pPtc2[0].y = D1 + D2 * pPtc2[0].x;
			pPtc2[0].y = - D1 + D2 * pPtc2[0].x;    //the code was changed by lwh on 2012.3.16
			return 1;
			//### Changed for inducing erroes... 20120117

		}
        else if((D3 < 0)) 
        {
			// no solution:
			return 0;
		} 
        else 
        {
			D3 = MATH_SQRT(D3);            //MATH_SQRT = sqrtf
			pPtc2[0].x = (B + D3) / 2 / A;
			//	pPtc2[0].y = D1 + D2 * pPtc2[0].x;
			pPtc2[0].y = - D1 + D2 * pPtc2[0].x;    //the code was changed by lwh on 2012.3.16

			pPtc2[1].x = (B - D3) / 2 / A;
			//	pPtc2[1].y = D1 + D2 * pPtc2[1].x;
			pPtc2[1].y = - D1 + D2 * pPtc2[1].x;     //the code was changed by lwh on 2012.3.16

     		return 2;
		}

	} 
    else 
    {
		D4 = Ptc0.y * Ptc0.y - R0 * R0;
		D1 = (Ptc1.x * Ptc1.x + Ptc1.y * Ptc1.y - D4 - R1 * R1 - Ptc0.x * Ptc0.x) / 2 / D5;
		D2 = D3 / D5;
		D3 = D1 - Ptc0.x;

		A = D2 * D2 + 1;
		B = 2.0 * (Ptc0.y - D2 * D3);
		C = D3 * D3 + D4;

		D3 = B * B - 4.0 * A * C;

		//### Changed for inducing erroes... 20120117

		if((MATH_FABS(D0 - MATH_FABS(R0 + R1)) <= APA_TRAJCAL_DIS_CAL_VALUE_IS_EQUAL_TOL)
		    || (MATH_FABS(D0 - MATH_FABS(R0 - R1)) <= APA_TRAJCAL_DIS_CAL_VALUE_IS_EQUAL_TOL)) 
        {

			//		if(MATH_FABS(D3) <= APA_TRAJCAL_DIS_CAL_SQRT_VALUE_IS_ZERO_TOL){   // MATH_FABS=fabsf        APA_TRAJCAL_DIS_CAL_SQRT_VALUE_IS_ZERO_TOL =400
			// Only one solution:
			// ??? Error ??
			pPtc2[0].y = (B) / 2 / A;
			pPtc2[0].x = D1 + D2 * pPtc2[0].y;
			return 1;
			//### Changed for inducing erroes... 20120117

		} 
        else if((D3 < 0)) 
        {
			// no solution:
			return 0;
		} 
        else 
        {
			D3 = MATH_SQRT(D3);            //MATH_SQRT = sqrtf
			pPtc2[0].y = (B + D3) / 2 / A;
			pPtc2[0].x = D1 + D2 * pPtc2[0].y;

			pPtc2[1].y = (B - D3) / 2 / A;
			pPtc2[1].x = D1 + D2 * pPtc2[1].y;

			return 2;
		}
	}
}

#else

#endif
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
void APATrajCalCarPosByCarCenterPtAndPtOnCarSideLine(
                                                        APACoordinateDataCalFloatType PtOnSideLine,
                                                        APA_DISTANCE_CAL_FLOAT_TYPE DisBtCenterPtAndPtOnSideLine,
                                                        APA_DISTANCE_CAL_FLOAT_TYPE DisBtCenterPtAndSideLine,
                                                        APA_DISTANCE_CAL_FLOAT_TYPE TurningRadius,
                                                        APACoordinateDataCalFloatType CarCenterPt,
                                                        APA_ENUM_TYPE CarSideLineType,
                                                        BOOLEAN bDriveClockWise,
                                                        APACarCoordinateDataCalFloatType * pCarPos) 
{
	// This function can replace the function: APATrajCalCarPosByCarCornerPosAndTurningCenterPt
	// PtOnSideLine: Pt on the car side line. It can be car left side ,
	// car right side line, car front bumper line or car rear bumper line.
	// CarSideLineType:
	// 0 - right or left side line
	// 1 - rear bumper line.
	// 2 - front bumper line.

	// DisBtCenterPtAndSideLine:
	// if CarSideLineType:
	// 0 - right or left side line, it will be the car turning center point and left or right side line + APACal.APATrajCalSafetyDisToObjAtSideOfCar.
	// 1 - rear bumper line. it will be the dis bt the point on the rear bumper and the rear axis line + APACal.APATrajCalSafetyDisToObjAtRear.
	// 2 - front bumper line. it will be the dis bt the point on the front bumper and the rear axis line + APACaPar.APACal.APATrajCalSafetyDisToObjAtFront.

	APA_ANGLE_CAL_FLOAT_TYPE Ang1, Ang2;

	// Cal the angle between the X axis and Pt on out side line.

	Ang1 = APATrajCalGetChordAngle(PtOnSideLine, CarCenterPt, DisBtCenterPtAndPtOnSideLine);

	// Cal the angle betwen the rear axis and Pt on out side line.
	if(CarSideLineType == 0) 
    {
		Ang2 = MATH_ACOS(DisBtCenterPtAndSideLine / DisBtCenterPtAndPtOnSideLine);

		// Cal angle between the rear axis and X axis.
		if(bDriveClockWise == FALSE) 
        {
			Ang2 = Ang1 - Ang2;
		} 
        else 
        {
			Ang2 = Ang1 + Ang2;
		}
	} 
    else 
    {
		Ang2 = MATH_ASIN(DisBtCenterPtAndSideLine / DisBtCenterPtAndPtOnSideLine);

		// Cal angle between the rear axis and X axis.
		if(CarSideLineType == 1) 
        {
			// rear bumper
			if(bDriveClockWise == FALSE) 
            {
				Ang2 = Ang1 + Ang2;
			} 
            else 
            {
				Ang2 = Ang1 - Ang2;
			}

		} 
        else 
        {
			// Front bumper.
			if(bDriveClockWise == FALSE) 
            {
				Ang2 = Ang1 - Ang2;
			} 
            else 
            {
				Ang2 = Ang1 + Ang2;
			}
		}
	}

	pCarPos->CarAng = APATrajCalGetCarAngleByRAxisChordAngle(Ang2, bDriveClockWise);
	pCarPos->Coordinate = APATrajCalPointOnArcWithArcCenterPtAndAngle(Ang2, TurningRadius, CarCenterPt);
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_ANGLE_CAL_FLOAT_TYPE APATrajCalGetChordAngle(
                                                    APACoordinateDataCalFloatType Pt1,
                                                    APACoordinateDataCalFloatType Ptc,
                                                    APA_DISTANCE_CAL_FLOAT_TYPE R) 
{
// Input Par:
// Pt1(X1, Y1) - Point on the circle.
// Ptc(Xc, Yc) - Center of the circle.
// R - Circle radius.should great than 0
//
// Output Par:
// ArcAngle: 0 ~ 360 deg.
//
//					^
// 					|	    + DstPt
// 					|	   /
// 					|	  /Radius
// 					|	 /
// 					|	/\ ArcAngle
//					|	+-----------
//					|	CenterPt
//		------------+------------>
//					|
//					|
//

	APA_ANGLE_CAL_FLOAT_TYPE Ang;
	APA_DISTANCE_CAL_FLOAT_TYPE DX;

	DX = Pt1.x - Ptc.x;
	if(DX > R) 
    {
		// Error,
		// should we check if it is within the tolerance????????????????????//
		return 0;
	} 
    else if(DX < -R) 
    {
		// Error,
		// should we check if it is within the tolerance????????????????????//
		return PI;
	}

	Ang = MATH_ACOS(DX / R);
	if(Pt1.y >= Ptc.y) 
    {
	} 
    else 
    {
		Ang = 2 * PI - Ang;
	}
	return Ang;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APA_ANGLE_CAL_FLOAT_TYPE APATrajCalGetCarAngleByRAxisChordAngle(
                                                                    APA_ANGLE_CAL_FLOAT_TYPE RearAxisChordAngle,
                                                                    BOOLEAN bCarDrivingClockWise) 
{
// Input Par:
// RearAxisChordAngle: 0 ~ 360 deg, from X = 0.
//
// Output parameter:
// CarAng - -180 deg ~ + 180 deg.
//
//
//		               ^    |
//                      \ CarAng > 0
//                       \  |
//                        \ |
//					^      \|
// 					|	    + DstPt
// 					|      /
// 					|     /Radius
// 					|    /
// 					|   / \ RearAxisChordAngle
//					|	+-----------
//					|	CenterPt
//		------------+------------>
//					|
//					|
//
//
//
	APA_ANGLE_CAL_FLOAT_TYPE Ang;

	if(bCarDrivingClockWise) 
    {
		Ang = RearAxisChordAngle - PI;
	} 
    else 
    {
		if(RearAxisChordAngle < PI) 
        {
			Ang = RearAxisChordAngle;
		} 
        else 
        {
			Ang = RearAxisChordAngle - 2.0 * PI;
		}
	}
	return Ang;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APACoordinateDataCalFloatType APATrajCalPointOnArcWithArcCenterPtAndAngle(
                                                                            APA_ANGLE_CAL_FLOAT_TYPE ArcAngle,
                                                                            APA_DISTANCE_CAL_FLOAT_TYPE Radius,
                                                                            APACoordinateDataCalFloatType CenterPt) 
{
//					^
// 					|	    + DstPt
// 					|	   /
// 					|	  /Radius
// 					|	 /
// 					|	/\ ArcAngle
//					|	+-----------
//					|	CenterPt
//		------------+------------>
//					|
//					|
//

	APACoordinateDataCalFloatType DstPt;

	DstPt.x = CenterPt.x + Radius * MATH_COS(ArcAngle);
	DstPt.y = CenterPt.y + Radius * MATH_SIN(ArcAngle);

	return DstPt;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APALineParameterABCType APATrajCalLineParABCByPerPendLineAndPointOnLine(
                                                                        APACoordinateDataCalFloatType PtOnLine,
                                                                        APALineParameterABCType *pPerPendLine) 
{
	// Input Parameter:
	// CarCurPt - current car position
	// LineType - 0: Line which has the same direction with the car and crosses the current car position.
	//          - 1: Line which is perpendicular with the car direction and crosses the current car position.
	// Output Parameter:
	// Line parameter A B C.
	// Vertical: X = C; A = 1;
	// Horizontal: Y = C; A = 0;
	// Incline: Y = AX + C;

	APALineParameterABCType LinePar;

	if(pPerPendLine->LineType == APALineIsHorizontal) 
    {
		LinePar.A = 1;
		LinePar.B = 1;
		LinePar.C = PtOnLine.x;
		LinePar.LineType = APALineIsVertical;
	} 
    else if(pPerPendLine->LineType == APALineIsVertical) 
    {
		LinePar.A = 0;
		LinePar.B = 1;
		LinePar.C = PtOnLine.y;
		LinePar.LineType = APALineIsHorizontal;
	} 
    else 
    {
		LinePar.A = - 1.0 / (pPerPendLine->A);
		LinePar.B = 1;
		LinePar.C = PtOnLine.y - LinePar.A * PtOnLine.x;
		LinePar.LineType = APALineIsIncline;
	}
	return LinePar;
}
/*************************************************************************************************************************************************
** Syntax :  Protect the input of tanf() keeping a small distanace from pi/2.                                                                   **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): float f32X                                                                                                                  **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: float32 cos value                                                                                                              **
**                                                                                                                                              **
** Description : Protect the input of tanf() keeping a small distanace from pi/2.                                                               **
*************************************************************************************************************************************************/
APACoordinateDataCalFloatType APATrajCalPointPosWithAngAndCenterPt(
                                                                    APACoordinateDataCalFloatType DstPt,
                                                                    APA_ANGLE_TYPE Angle,
                                                                    APACoordinateDataCalFloatType CenterPt) 
{
// The coordinate original point of the DstPt is the center point.
// the car center point is the mid of the rear axis.
// DstPt is relative to the car center point.
//
//    y |
//  \	   |
//   \  |
//    \Angle
//     \|___X
//
	APA_ANGLE_CAL_FLOAT_TYPE Ang;
	APACoordinateDataCalFloatType NewPt;
	APA_DISTANCE_CAL_FLOAT_TYPE X = DstPt.x;
	APA_DISTANCE_CAL_FLOAT_TYPE Y = DstPt.y;
	APA_DISTANCE_CAL_FLOAT_TYPE L = MATH_SQRT(X * X + Y * Y);

	if(L == 0) 
    {
		return CenterPt;
	}
	Ang = X / L;
	Ang = MATH_ACOS(Ang);

	if(X >= 0 && Y >= 0) 
    {
	} 
    else if(X < 0 && Y > 0) 
    {
		//Ang = PI - Ang;
		//} else if(X < 0 && Y < 0) {
		//	Ang = 2 * PI - Ang;
	} 
    else 
    {
		Ang = 2 * PI - Ang;
	}

	X = CenterPt.x + L * MATH_COS(Ang + Angle);
	Y = CenterPt.y + L * MATH_SIN(Ang + Angle);

	NewPt.x = (APA_DISTANCE_CAL_FLOAT_TYPE)X;
	NewPt.y = (APA_DISTANCE_CAL_FLOAT_TYPE)Y;
	return NewPt;
}

/*************************************************************************************************************************************************
** Syntax :  APA_DISTANCE_CAL_FLOAT_TYPE APATrajCalLineParCByParallelLineAndDisToLine(APA_DISTANCE_CAL_FLOAT_TYPE DisToLine,					**
**                                                                         APALineParameterABCType *pParallelLine) 								**			                                                                                                                    **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): none                                                                                                                        **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: none                                                                                                                           **
**                                                                                                                                              **
** Description : ..                                                                                                                             **
*************************************************************************************************************************************************/
APA_DISTANCE_CAL_FLOAT_TYPE APATrajCalLineParCByParallelLineAndDisToLine(APA_DISTANCE_CAL_FLOAT_TYPE DisToLine,
                                                                         APALineParameterABCType *pParallelLine)
{
  // Input Parameter:
  // CarCurPt - current car position
  // DisToLine: > 0 is above the line or at right side of the line,
  // 				< 0 is under the line or at left side of the line.

  // Output Parameter:
  // Line parameter C.
  // Vertical: X = C; A = 1;
  // Horizontal: Y = C; A = 0;
  // Incline: Y = AX + C;

  APA_DISTANCE_CAL_FLOAT_TYPE C;

  if (pParallelLine->LineType == APALineIsIncline) {
    C = MATH_SQRT(pParallelLine->A * pParallelLine->A + pParallelLine->B * pParallelLine->B) * DisToLine;
    C += pParallelLine->C;
  } else {
    C = pParallelLine->C + DisToLine;
  }
  return C;
}

/*************************************************************************************************************************************************
** Syntax :  APA_ENUM_TYPE APATrajCalCheckIfTheLineIsVerticalOrHorizontalByTwoPoint(APACoordinateDataCalFloatType Pt1,							**
**                                                                       APACoordinateDataCalFloatType Pt2,										**
**                                                                       APA_DISTANCE_CAL_FLOAT_TYPE *pKLine)         							**                                                                                                             **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): none                                                                                                                        **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: none                                                                                                                           **
**                                                                                                                                              **
** Description : ..                                                                                                                             **
*************************************************************************************************************************************************/
APA_ENUM_TYPE APATrajCalCheckIfTheLineIsVerticalOrHorizontalByTwoPoint(APACoordinateDataCalFloatType Pt1,
                                                                       APACoordinateDataCalFloatType Pt2,
                                                                       APA_DISTANCE_CAL_FLOAT_TYPE *pKLine) 
{
  // return value:
  // 0 -- Normal, ie. oblique line. inclined line
  // 1 - vertical.
  // 2 - horizontal.
  APA_DISTANCE_CAL_FLOAT_TYPE DX, DY, K;

  DX = Pt1.x - Pt2.x;
  if (DX == 0) {
    // Vertical
    return 1;
  } else {
    DY = Pt1.y - Pt2.y;

    (*pKLine) = DY / DX;
    K         = MATH_FABS((*pKLine));
    if (K > APACal.APATrajCalLineIsVMaxK) {
      // Vertical
      return 1;
    } else if (K < APACal.APATrajCalLineIsHMinK) {
      // Horizotal.
      return 2;
    } else {
      // Line Lc is a normal line.
      // Normal line
      return 0;
    }
  }
}

/*************************************************************************************************************************************************
** Syntax :  APA_ENUM_TYPE APATrajCalCheckIfThePointIsAtLeftOrRightSideOfALine(APALineParameterABCType *pLine, APACoordinateDataCalFloatType Pt)**                                                                                                                     **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): none                                                                                                                        **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: none                                                                                                                           **
**                                                                                                                                              **
** Description : ..                                                                                                                             **
*************************************************************************************************************************************************/
APA_ENUM_TYPE APATrajCalCheckIfThePointIsAtLeftOrRightSideOfALine(APALineParameterABCType *pLine, APACoordinateDataCalFloatType Pt) 
{
  // return value:
  /*
  APATrajCalPointIsAtAboveOfLine = 0, // Only used when line is horizontal.
  APATrajCalPointIsAtUnderOfLine, // Only used when line is horizontal.
  APATrajCalPointIsAtLeftOfLine, // Used when line is vertical or incline.
  APATrajCalPointIsAtRightOfLine, // Used when line is vertical or incline.
  APATrajCalPointIsOnLine, // Point is on line with a tollerance.
  */

  APA_DISTANCE_CAL_FLOAT_TYPE Dis;

  if (pLine->LineType == APALineIsHorizontal) {
    // Check if the point is above or under the line.
    Dis = (Pt.y - pLine->C);

    if (MATH_FABS(Dis) < APA_TRAJCAL_POINT_IS_ON_LINE_MAX_DIS_TOL) {
      return APATrajCalPointIsOnLine;
    } else if (Dis > 0) {
      return APATrajCalPointIsAtAboveOfLine;
    } else {
      return APATrajCalPointIsAtUnderOfLine;
    }
  } else if (pLine->LineType == APALineIsVertical) {
    // Check if the point is at left or righ side of the line.
    Dis = (Pt.x - pLine->C);

    if (MATH_FABS(Dis) < APA_TRAJCAL_POINT_IS_ON_LINE_MAX_DIS_TOL) {
      return APATrajCalPointIsOnLine;
    } else if (Dis > 0) {
      return APATrajCalPointIsAtRightOfLine;
    } else {
      return APATrajCalPointIsAtLeftOfLine;
    }

  } else {
    // Line is incline.
    if ((pLine->A < -1.0) || (pLine->A > 1.0)) {
      Dis = Pt.x - (Pt.y - pLine->C) / pLine->A; // X
    } else {
      Dis = Pt.y - (pLine->A * Pt.x + pLine->C); // Y
      if (pLine->A > 0) {
        Dis = -Dis;
      }
    }

    if (MATH_FABS(Dis) < APA_TRAJCAL_POINT_IS_ON_LINE_MAX_DIS_TOL) {
      return APATrajCalPointIsOnLine;
    } else if ((Dis > 0)) {
      return APATrajCalPointIsAtRightOfLine;
    } else {
      return APATrajCalPointIsAtLeftOfLine;
    }
  }
}

/*************************************************************************************************************************************************
** Syntax :  APA_INT_TYPE IntegerAbs(APA_INT_TYPE x)                                                                                            **
**                                                                                                                                              **
** Service ID:   : NA                                                                                                                           **
**                                                                                                                                              **
** Sync/Async:   : Synchronous                                                                                                                  **
**                                                                                                                                              **
** Reentrancy:   : Non Reentrant                                                                                                                **
**                                                                                                                                              **
** Parameters (in): none                                                                                                                        **
**                                                                                                                                              **
** Parameters (out): none                                                                                                                       **
**                                                                                                                                              **
** Return value: none                                                                                                                           **
**                                                                                                                                              **
** Description : ..                                                                                                                             **
*************************************************************************************************************************************************/
APA_INT_TYPE IntegerAbs(APA_INT_TYPE x) 
{
  if (x < 0) {
    x = -x;
  }
  return x;
}
#define ALG_STOP_SEC_CODE
#include "IS31_UserMemMap.h"
/*************************************************************************************************************************************************
**                                                     End of file                                                                              **
*************************************************************************************************************************************************/






